Version =20
VersionRequired =20
Begin Form
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    DefaultView =0
    ScrollBars =0
    BorderStyle =3
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridY =10
    Width =11338
    DatasheetFontHeight =11
    ItemSuffix =37
    Left =3255
    Top =735
    Right =14595
    Bottom =11100
    DatasheetGridlinesColor =15132391
    RecSrcDt = Begin
        0x2562231676dbe540
    End
    Caption ="Récapitulatif des changements après le Scan"
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    AllowDatasheetView =0
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    AllowLayoutView =0
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =60.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            Width =1701
            Height =1701
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            Width =1701
            Height =1701
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin FormHeader
            Height =566
            BackColor =3684411
            Name ="EntêteFormulaire"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =3
            BackShade =25.0
            Begin
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =10034
                    Top =113
                    Width =960
                    Height =330
                    ForeColor =4210752
                    Name ="cmdAfficheInfo"
                    Caption =" Info"
                    OnClick ="[Event Procedure]"
                    Picture ="ic_Aide.png"
                    GridlineColor =10921638
                    ImageData = Begin
                        0x89504e470d0a1a0a0000000d49484452000000100000001008060000001ff3ff ,
                        0x6100000006624b4744000000000000f943bb7f000000097048597300000b1300 ,
                        0x000b1301009a9c1800000009767041670000001000000010005cc6adc3000002 ,
                        0xf94944415438cb6593cb6b9c6514c67fef65be4c663293cb64a663c624a498b4 ,
                        0x915034501a94d2228a141762a9086ebcac05372e15d78a0bff02bb100cdec085 ,
                        0x1b15b1246dbca0ad42ad99d4a44dc98dce64ee97cc37dff71e176924c60367f7 ,
                        0x3cbf730e9c47f1ff1a323632d33798396f6303534ed041bb76b75dbdbf10f89d ,
                        0x1b4011080fc4ea90d100934323c7df489f9cbb94187b6c58e2695ddf0b099b25 ,
                        0xf1b76f556bab3f7d53df5cf9d089bb01f847018f66271fff60fceccbcf78a3b3 ,
                        0xd627821f0ab5764037142c21bab8ec2abf7ef6fb6e7ee94d11f91108cd03737a ,
                        0x7874eadd89a75ebf68c7cf58df698c8644d4628da2e58704a291be8c4a0ce7b2 ,
                        0xd4b71e6e9777ae02650b9888d733979d3977d11b9b357ba190497abcffd23483 ,
                        0xf1084e845fd6aabcfd459efa5e80a4a6546ae6e973adc2fa8576adf49106fa93 ,
                        0x99b1e7fa1f3993ec8a45447876264d27745c5ebcc7d2ed32e7a753bc783a8b52 ,
                        0xa09422363edb933836f13c306c81647c68645627b2ca778208fc7dbfc9fccf9b ,
                        0x941b5d32c91ece9e48911b8a62b5c268858da788a7c74e70fbb7010b446d2c31 ,
                        0xe84c0fce09a10857964b844e48273dde796112a315d7ef56d16a1fa0adc58bf7 ,
                        0xf76945bf06101786ce399c8008382738275c3afd1033b9240bf95dbebd592462 ,
                        0xf601462b940b9d08be069a9d467913bf8113f94f0fc4227c77b3c05bf3b7fe35 ,
                        0x1aadb0e2e3377677051a1a28370b1bd73ac53b210a8250f003210821bfd3e08f ,
                        0x7bd507b783d1608d426adb52dfb9731d2868a0512b6c7c5dfa6b6143da55da5d ,
                        0x871fee6ff0cadc08af3e913b345d13555d2acb8b95caf6daa740f5e091aa7ebd ,
                        0x24d1dede2723a9e39100831398cec529363a5cc957f08c266e1d9dd5abddf5a5 ,
                        0x2f2f37abbb9f00b50380dfedb456fdf206bdda3f151fc8449517e3877c85c595 ,
                        0x0ab108c4820aadfcf7edf56b9fcf97b6d6de03368e660120edc51217fa73275f ,
                        0xebcb4d9ff206b271638c72cd62bbb1b9bc525afff3e356adf415b07590c8a300 ,
                        0x000f38668c9df07a63a3a06c77afb51504dd55601b681f16ff03d141689ccdfb ,
                        0x012a0000001d74455874436f6d6d656e74004372656174656420776974682054 ,
                        0x68652047494d50ef64256e00000025744558746372656174652d646174650032 ,
                        0x3030392d31312d31375432303a30363a35352d30373a303059a62abb00000025 ,
                        0x74455874646174653a63726561746500323031302d30312d31315431343a3239 ,
                        0x3a35392d30373a3030eb6c0cbd0000002574455874646174653a6d6f64696679 ,
                        0x00323031302d30312d31315431343a32393a35392d30373a30309a31b4010000 ,
                        0x0034744558744c6963656e736500687474703a2f2f6372656174697665636f6d ,
                        0x6d6f6e732e6f72672f6c6963656e7365732f47504c2f322e302f6c6a06a80000 ,
                        0x0025744558746d6f646966792d6461746500323030392d31312d31375432303a ,
                        0x30363a35352d30373a303006175c8f0000001874455874536f7572636500496e ,
                        0x7472696775652049636f6e20536574ae27a13f0000004674455874536f757263 ,
                        0x655f55524c00687474703a2f2f73696d706c65696e6e6f766174696f6e2e6e65 ,
                        0x742f696e6465782e7068703f706167653d323226736f757263653d322669643d ,
                        0x329541f9c60000000049454e44ae426082
                    End

                    LayoutCachedLeft =10034
                    LayoutCachedTop =113
                    LayoutCachedWidth =10994
                    LayoutCachedHeight =443
                    PictureCaptionArrangement =5
                    UseTheme =0
                    BackColor =14461583
                    BorderColor =14461583
                    HoverColor =15189940
                    PressedColor =9917743
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                Begin CheckBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =4372
                    Top =176
                    TabIndex =1
                    BorderColor =10921638
                    Name ="chkScan"
                    AfterUpdate ="=AppliqueFiltre(\"Scan\")"
                    DefaultValue ="0"
                    GridlineColor =10921638

                    LayoutCachedLeft =4372
                    LayoutCachedTop =176
                    LayoutCachedWidth =4632
                    LayoutCachedHeight =416
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =2
                            TextFontFamily =18
                            Left =3975
                            Top =120
                            Width =284
                            Height =340
                            ForeColor =2366701
                            Name ="lbl_chkScan"
                            Caption ="="
                            FontName ="Webdings"
                            GridlineColor =10921638
                            LayoutCachedLeft =3975
                            LayoutCachedTop =120
                            LayoutCachedWidth =4259
                            LayoutCachedHeight =460
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =1
                            BorderTint =100.0
                            BorderShade =65.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin CheckBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =5385
                    Top =169
                    TabIndex =2
                    BorderColor =10921638
                    Name ="chkModif"
                    AfterUpdate ="=AppliqueFiltre(\"Modif\")"
                    DefaultValue ="0"
                    GridlineColor =10921638

                    LayoutCachedLeft =5385
                    LayoutCachedTop =169
                    LayoutCachedWidth =5645
                    LayoutCachedHeight =409
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =2
                            TextAlign =2
                            TextFontFamily =18
                            Left =4988
                            Top =113
                            Width =284
                            Height =345
                            Name ="lbl_chkModif"
                            Caption ="="
                            FontName ="Webdings"
                            GridlineColor =10921638
                            LayoutCachedLeft =4988
                            LayoutCachedTop =113
                            LayoutCachedWidth =5272
                            LayoutCachedHeight =458
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =1
                            BorderTint =100.0
                            BorderShade =65.0
                            ForeThemeColorIndex =8
                            ForeTint =100.0
                            ForeShade =75.0
                        End
                    End
                End
                Begin CheckBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =6406
                    Top =169
                    TabIndex =3
                    BorderColor =10921638
                    Name ="chkNouv"
                    AfterUpdate ="=AppliqueFiltre(\"Nouv\")"
                    DefaultValue ="0"
                    GridlineColor =10921638

                    LayoutCachedLeft =6406
                    LayoutCachedTop =169
                    LayoutCachedWidth =6666
                    LayoutCachedHeight =409
                    GridlineThemeColorIndex =-1
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =2
                            TextAlign =2
                            TextFontFamily =18
                            Left =6009
                            Top =113
                            Width =284
                            Height =340
                            BorderColor =10921638
                            ForeColor =3506772
                            Name ="lbl_chkNouv"
                            Caption ="="
                            FontName ="Webdings"
                            GridlineColor =10921638
                            LayoutCachedLeft =6009
                            LayoutCachedTop =113
                            LayoutCachedWidth =6293
                            LayoutCachedHeight =453
                            ThemeFontIndex =-1
                            BackThemeColorIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            BorderShade =65.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                            ForeShade =75.0
                            GridlineThemeColorIndex =-1
                        End
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =1474
                    Top =113
                    Width =2160
                    Height =315
                    BorderColor =8355711
                    ForeColor =13421772
                    Name ="lblChksInfo"
                    Caption ="Afficher uniquement :"
                    GridlineColor =10921638
                    LayoutCachedLeft =1474
                    LayoutCachedTop =113
                    LayoutCachedWidth =3634
                    LayoutCachedHeight =428
                    ForeTint =20.0
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =9864
            Name ="Détail"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
            Begin
                Begin Subform
                    OverlapFlags =85
                    Left =566
                    Top =170
                    Width =10470
                    Height =2040
                    BorderColor =10921638
                    Name ="sfO"
                    SourceObject ="Form.F_RecapSFO"
                    GridlineColor =10921638

                    LayoutCachedLeft =566
                    LayoutCachedTop =170
                    LayoutCachedWidth =11036
                    LayoutCachedHeight =2210
                    Begin
                        Begin Label
                            Vertical = NotDefault
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =2
                            Left =113
                            Top =170
                            Width =375
                            Height =2040
                            BorderColor =8355711
                            ForeColor =6710886
                            Name ="lbl_sfO"
                            Caption ="Objets"
                            GridlineColor =10921638
                            LayoutCachedLeft =113
                            LayoutCachedTop =170
                            LayoutCachedWidth =488
                            LayoutCachedHeight =2210
                            BackThemeColorIndex =4
                            BackTint =40.0
                        End
                    End
                End
                Begin Subform
                    OverlapFlags =85
                    Left =566
                    Top =2437
                    Width =10470
                    Height =3075
                    TabIndex =1
                    BorderColor =10921638
                    Name ="sfC"
                    SourceObject ="Form.F_RecapSFC"
                    GridlineColor =10921638

                    LayoutCachedLeft =566
                    LayoutCachedTop =2437
                    LayoutCachedWidth =11036
                    LayoutCachedHeight =5512
                    Begin
                        Begin Label
                            Vertical = NotDefault
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =2
                            Left =113
                            Top =2437
                            Width =375
                            Height =3075
                            BorderColor =8355711
                            ForeColor =6710886
                            Name ="lbl_sfC"
                            Caption ="Contrôles"
                            GridlineColor =10921638
                            LayoutCachedLeft =113
                            LayoutCachedTop =2437
                            LayoutCachedWidth =488
                            LayoutCachedHeight =5512
                            BackThemeColorIndex =9
                            BackTint =30.0
                        End
                    End
                End
                Begin Subform
                    OverlapFlags =85
                    Left =566
                    Top =5725
                    Width =10485
                    Height =4035
                    TabIndex =2
                    BorderColor =10921638
                    Name ="sfT"
                    SourceObject ="Form.F_RecapSFT"
                    GridlineColor =10921638

                    LayoutCachedLeft =566
                    LayoutCachedTop =5725
                    LayoutCachedWidth =11051
                    LayoutCachedHeight =9760
                    Begin
                        Begin Label
                            Vertical = NotDefault
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =2
                            Left =113
                            Top =5725
                            Width =375
                            Height =4035
                            BorderColor =8355711
                            ForeColor =6710886
                            Name ="lbl_sfT"
                            Caption ="Propriétés :"
                            GridlineColor =10921638
                            LayoutCachedLeft =113
                            LayoutCachedTop =5725
                            LayoutCachedWidth =488
                            LayoutCachedHeight =9760
                            BackThemeColorIndex =5
                            BackTint =60.0
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =0
            Name ="PiedFormulaire"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'@Folder("Dev")
Option Compare Database
Option Explicit

    Private bFrmInfoIsOpen As Boolean

'// Chargement de données suvant la base.
Private Sub Form_Open(Cancel As Integer)

    If IsNull(Me.OpenArgs()) Then
        Cancel = True
        DoCmd.Close
        Exit Sub
    End If

    Dim Args() As String
    Dim sSql   As String

    Args = Split(Me.OpenArgs(), ";")

    sSql = "SELECT T_Objets.ObjetType, T_Objets.ObjetNom, T_Objets.Scanner, T_Objets.Nouveau, " & _
           "IIf(Scanner=False,""="",Null) AS Scan, IIf(Nouveau=True,""="",Null) AS Nouv " & _
           "FROM T_Objets " & _
           "WHERE ((T_Objets.ObjetApp)='" & Args(0) & "') " & _
           "ORDER BY T_Objets.ObjetNom;"

    Me.sfO.Form.RecordSource = sSql

    sSql = "SELECT T_ObjetControles.Control_ID, T_ObjetControles.Scanner, T_ObjetControles.Nouveau, " & _
           "IIf(Scanner=False,""="",Null) AS Scan, " & _
           "IIf(Nouveau=True,""="",Null) AS Nouv " & _
           "FROM T_ObjetControles " & _
           "WHERE ((T_ObjetControles.Control_ID) Like ('" & Args(0) & ".*')) " & _
           "ORDER BY T_ObjetControles.Control_ID;"

    Me.sfC.Form.RecordSource = sSql

    sSql = "SELECT T_TradTexte.Trad_ID, T_TradTexte.PropNom, T_TradTexte.PropTexte, " & _
           "T_TradTexte.ModPropTexte, T_TradTexte.Scanner, T_TradTexte.Nouveau, " & _
           "IIf(Scanner=False,""="",Null) AS Scan, " & _
           "IIf(ModPropTexte=True,""="",Null) AS Modif, " & _
           "IIf(Nouveau=True,""="",Null) AS Nouv " & _
           "FROM T_TradTexte " & _
           "WHERE ((T_TradTexte.Trad_ID) Like ('" & Args(0) & ".*')) " & _
           "ORDER BY T_TradTexte.Trad_ID;"

    Me.sfT.Form.RecordSource = sSql

    If (UBound(Args()) > 0) Then Me.Caption = Me.Caption & " (" & Args(1) & ")"

End Sub

Private Sub Form_Close()
    If bFrmInfoIsOpen Then DoCmd.Close acForm, "F_InfoRecap"
End Sub

Private Sub cmdAfficheInfo_Click()
    bFrmInfoIsOpen = True
    DoCmd.OpenForm "F_InfoRecap"
End Sub

'// Filtrage suivant choix des chkBox.
Private Function AppliqueFiltre(ChkNom As String) As Boolean

    If ResetFiltres Then Exit Function

    Select Case ChkNom
        Case "Nouv"
            Me.chkModif = False     '// Ne peux pas être Scan et Mod si Nouveau.
            Me.chkScan = False
        Case "Modif", "Scan"
            Me.chkNouv = False      '// Ne peux pas être Nouv si Scan ou Modif.
        Case Else
            Exit Function
    End Select

    Dim sFiltre As String
    Dim bFiltre As Boolean
    Dim sFltO   As String
    Dim sFltC   As String
    Dim sFltP   As String

    sFltO = "ObjetType='X'"   '// Masque les données car pas de filtre Modif sur Objet et Control.
    sFltC = "Control_ID='X'"  '// ...

    If (Me.chkNouv) Then sFiltre = "Nouveau=True": bFiltre = True

    If (Me.chkScan) Then sFiltre = "Scanner=False": bFiltre = True

    If (Me.chkModif) Then
        sFltP = "ModPropTexte=True"
        If (Len(sFiltre) > 0) Then sFltP = sFltP & " AND " & sFiltre
    Else
        sFltP = sFiltre
    End If

    Me.sfO.Form.Filter = IIf(bFiltre, sFiltre, sFltO)
    Me.sfO.Form.FilterOn = True
    Me.sfC.Form.Filter = IIf(bFiltre, sFiltre, sFltC)
    Me.sfC.Form.FilterOn = True
    Me.sfT.Form.Filter = sFltP
    Me.sfT.Form.FilterOn = True

End Function

Private Function ResetFiltres() As Boolean
    If (Me.chkScan = False) And (Me.chkNouv = False) And (Me.chkModif = False) Then
        Me.sfO.Form.FilterOn = False
        Me.sfC.Form.FilterOn = False
        Me.sfT.Form.FilterOn = False
        ResetFiltres = True
    End If
End Function
